-------------------DAY 1---------------
Q1. Find 2nd Highest Salary

select * from(

select * , dense_rank() over
(order by salary desc) as rank

from Employees

) as t

where rank =2;

Q2- Find Employees Joined in Last 30 Days

select * from Employees
where JoinDate >= DATEADD(DAY,-30,GETDATE())

Q3. Count Employees Department-wise

select DeptId , count(EmpId) as TotalEmployee 
from Employees
group by DeptId;

-----------------------DAY2-------------------
Q1. Find 3rd Highest Salary

select * from(
select * , dense_rank() over
(order by Salary desc) as rank
from Employees
) as temptable
where rank=3

Q2. Find Department with Maximum Employees

select top 1 DeptId, count(EmpId) asTotlEmployee
from Employees
group by DeptId
order by count(EmpId) desc;

Q3. Fetch Employees Who Joined in Last 6 Months

select * from Employees
where JoinDate >= Dateadd(DAY,-9,GETDATE());

-----------------------------DAY 3-------------------------------------
游릭 Q1.Write query to fetch top 3 highest salaries.

Select Top 3 * from Employees
Order by Salary desc

Q2. Write query to find employees earning more than their department average.

select *
from Employees e
where Salary >
(select avg(e2.Salary) from Employees e2
where e.DeptId=e2.DeptId);

游릭 Q3.Write query to find duplicate employee names.

select Name , count(*) as DuplicateEmp 
from Employees
group by Name
having count(*)>1;

游릭 Q4.Write query to update salary by 10% for employees in DeptId = 2.

Update Employees
set Salary = Salary+ Salary*10/100
where DeptId=2

游릭 Q5.Write query to fetch employees who joined between '2024-01-01' and '2024-12-31'.

SELECT *
FROM Employees
WHERE JoinDate >= '2020-01-01'
  AND JoinDate < '2022-01-01';



----------------------------------------DAY 4---------------------------------------------
游릭 Q1.Write query to fetch employee(s) having the 2nd lowest salary.

select * from(
Select * , Dense_rank() over
(Order by Salary asc) as rank
from Employees
) as temp
where rank =2;

游릭 Q2.Write query to fetch departments having more than 5 employees.

Select DeptId , COUNT(EmpId) as TotalEmployee
From Employees
group by DeptId
having COUNT(EmpId) >=5

游릭 Q3.Write query to fetch employees whose salary is between 30000 and 60000.

Select * from Employees
where Salary between 30000 and 60000;

游릭 Q4.Write query to find employees who share the same salary.

Select * from Employees
Where Salary in (
Select Salary from Employees
group by Salary
Having count(*)>1
)order by Salary asc

游릭 Q5.Write query to fetch employees who joined in the current year.

Select * from Employees
Where YEAR(JoinDate) = YEAR(GETDATE());

--------------------------------DAY 5 -------------------------------------------

游릭 Q1.Write query to fetch the employee(s) having highest salary overall.

Select * from(
Select * ,DENSE_RANK() over
(order by Salary desc) as rank
from Employees
) as temptable
where rank =1

游릭 Q2.Write query to find the total salary expense department-wise.

Select DeptId , Sum(Salary) as Totalsalary
from Employees
group by DeptId

游릭 Q3. Write query to fetch employees whose salary is greater than 2nd highest salary.

Select * from Employees
Where Salary >(
Select Salary from(
Select Salary ,DENSE_RANK() over
(order by Salary desc) as rank
from Employees
) as temptable
where rank =2
)

游릭 Q4.Write query to fetch employees who do not belong to DeptId = 3.

Select * from Employees
Where DeptId !=3;

游릭 Q5.Write query to find employees hired in the month of January (any year).


Select * from Employees
Where MONTH(JoinDate) =1;









































